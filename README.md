# Elastic分布式定时任务管理系统框架


## 项目功能
Elastic分布式任务管理系统，可以帮助用户管理定时任务的分发与执行。
区别于传统的单点定时任务系统，Elastic任务管理系统具有更高的可用性。
## 如何使用
用户需要重写service中的runJob，实现任务执行的具体业务。编写完成后需要初始化MySQL和Redis便可开始运行。用户可以通过客户端的AddJob方法将任务发送到服务器，等待服务器调度任务。
## 具体设计
项目分为主节点、从节点与客户端
### 1.主从选举
节点初次启动进行模式选择，检查自身是否获取到redis集群锁，若以获取到则以主节点模式启动，发布gRPC服务，并将ip和port存放到redis中，没有获取到则以从节点模式启动，读取redis中的信息后连接至主节点。
节点启动后会立刻开启一个线程，每隔一段时间拉取redis中的集群锁。每次获取到集群锁的节点都要比较redis中存放的ip和端口号是否与自身的相同，相同则代表主机点没有改变，继续当前服务。不同则要重新发布gRPC服务，并将redis中的ip和port更换为自身的。
### 2.主从节点间通信，客户端与从节点间通信
主从节点间通信采用的是gRPC服务，考虑到gRPC优秀的性能而且可以使用Protobuf自动生成客户端和服务器端代码。
## 目录树
├─src
│ └─main
│    └──java
│      ├─com
│      │  └─choi
│      │      ├─config
│      │      ├─controller
│      │      ├─grpc gRPC服务
│      │      ├─mapper
│      │      ├─pojo
│      │      ├─service
│      │      │  ├─client 从节点业务
│      │      │  └─server 主节点业务
│      │      └─utils
│      └─proto
└─ README.md




